<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Android Code & XML Loader</title>
  <script type="module" src="https://unpkg.com/@material/web/all.js"></script>
  <style>
    body {
      font-family: sans-serif;
      padding: 2rem;
      background-color: #f0f0f0;
    }
    .container {
      max-width: 1000px;
      margin: auto;
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
    }
    textarea, input {
      width: 100%;
      padding: 1rem;
      font-family: monospace;
      font-size: 14px;
      border-radius: 10px;
      border: 1px solid #ccc;
      resize: vertical;
    }
    h4 {
      margin-bottom: 0;
    }
  </style>
</head>
<body>

  <div class="container">
    <h2>Code Fetch & Convert (Java/Kotlin + XML)</h2>

    <input id="codeUrl" placeholder="Paste Kotlin/Java code URL (raw)"/>
    <input id="xmlUrl" placeholder="Paste XML layout URL (raw)"/>

    <md-filled-button onclick="loadAndConvert()">Load & Convert</md-filled-button>

    <p><strong>Detected Language:</strong> <span id="language"></span></p>

    <h4>Original Code</h4>
    <textarea id="originalCode" readonly></textarea>

    <h4>Converted Code</h4>
    <textarea id="convertedCode" readonly></textarea>

    <h4>XML Layout</h4>
    <textarea id="xmlCode" readonly></textarea>
  </div>

  <script>
    async function loadAndConvert() {
      const codeUrl = document.getElementById("codeUrl").value;
      const xmlUrl = document.getElementById("xmlUrl").value;

      const codeArea = document.getElementById("originalCode");
      const convertedArea = document.getElementById("convertedCode");
      const xmlArea = document.getElementById("xmlCode");
      const langLabel = document.getElementById("language");

      codeArea.value = "Loading...";
      xmlArea.value = "Loading...";
      convertedArea.value = "";
      langLabel.textContent = "";

      try {
        const codeRes = await fetch(codeUrl);
        const xmlRes = await fetch(xmlUrl);
        if (!codeRes.ok || !xmlRes.ok) throw new Error("One or both files failed to load.");

        const codeText = await codeRes.text();
        const xmlText = await xmlRes.text();

        codeArea.value = codeText;
        xmlArea.value = xmlText;

        const lang = detectLanguage(codeText);
        langLabel.textContent = lang;

        const converted = (lang === "Java") ? convertJavaToKotlin(codeText) : convertKotlinToJava(codeText);
        convertedArea.value = converted;
      } catch (err) {
        codeArea.value = "Error: " + err.message;
        xmlArea.value = "";
        convertedArea.value = "";
      }
    }

    function detectLanguage(code) {
      if (code.includes("System.out.println") || code.includes("public class")) return "Java";
      if (code.includes("fun ") || code.includes("val ") || code.includes("var ")) return "Kotlin";
      return "Unknown";
    }

    function convertJavaToKotlin(code) {
      return code
        .replace(/System\.out\.println/g, "println")
        .replace(/\bString\b/g, "var")
        .replace(/\bint\b/g, "var")
        .replace(/public static void mainString args/g, "fun main()")
        .replace(/;/g, "")
        .replace(/\{/g, "{\n");
    }

    function convertKotlinToJava(code) {
      return code
        .replace(/\bprintln\b/g, "System.out.println")
        .replace(/\bval\b/g, "final")
        .replace(/\bvar\b/g, "int")
        .replace(/fun main/g, "public static void main(String[] args)");
    }
  </script>

</body>
</html>